/* --- App.css (주석 및 최적화 완료, 앞 공백 제거) --- */

/* --------------------------------- */
/* :root - 색상 변수 정의            */
/* --------------------------------- */
/* 앱 전체에서 사용될 색상 팔레트를 변수로 정의하여 일관성을 유지하고 관리를 용이하게 합니다. */

/* --------------------------------- */
/* 전역 및 기본 레이아웃              */
/* --------------------------------- */
body {
    background-color: var(--dark-bg-1);
    color: var(--text-light);
    font-family: 'Inter', sans-serif;
    margin: 0;
    overflow: hidden; /* 스크롤바 숨김 */
}

/* 앱의 최상위 컨테이너. 화면 전체를 차지하며, jitsi 영역과 summary 영역을 가로로 나눕니다. */
.app-container {
    display: flex;
    height: 88vh;
    width: 100vw;
}

/* 왼쪽의 화상회의 메인 영역 컨테이너 */
.jitsi-container {
    flex-grow: 1; /* 남는 공간을 모두 차지 */
    display: flex;
    flex-direction: column;
    background-color: var(--dark-bg-1);
    padding: 20px;
    position: relative; /* 컨트롤 바의 기준점 */
}

/* 오른쪽의 회의 요약 사이드바 컨테이너 */
.summary-container {
    width: 35%;
    max-width: 500px;
    padding: 20px;
    background-color: var(--dark-bg-2);
    display: flex;
    flex-direction: column;
    height: 100vh;
    box-sizing: border-box;
    border-left: 1px solid #404040;
}

.summary-container h2 {
    margin-top: 0;
    border-bottom: 1px solid #404040;
    padding-bottom: 10px;
}

/* 요약 내용이 표시되는 박스 */
.summary-box {
    flex-grow: 1;
    background-color: var(--dark-bg-3);
    border-radius: 8px;
    padding: 15px;
    overflow: auto; /* 내용이 길어지면 스크롤 */
    white-space: pre-wrap; /* 줄바꿈 및 공백 유지 */
}

/* 요약 박스 내 Markdown 테이블 스타일 */
.summary-box table {
    width: 100%;
    border-collapse: collapse;
    margin: 1em 0;
    font-size: 0.9em;
}

.summary-box th,
.summary-box td {
    border: 1px solid var(--text-muted);
    padding: 8px;
    text-align: left;
    white-space: normal;
}

.summary-box th {
    background-color: #3a3e42;
    font-weight: 600;
}

/* --------------------------------- */
/* 로비 (회의 참가 전 화면)             */
/* --------------------------------- */
.join-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100%;
}

.join-container h1,
.join-container p {
    text-align: center;
}

.join-container input {
    padding: 10px;
    margin: 20px 0;
    width: 250px;
    border-radius: 5px;
    border: 1px solid var(--text-muted);
    background-color: var(--dark-bg-3);
    color: var(--text-light);
}

.join-container button {
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    background-color: var(--accent-color);
    color: white;
    cursor: pointer;
    font-size: 16px;
}

.join-container button:hover {
    background-color: #5a65c9; /* var(--accent-color)의 어두운 버전 */
}

/* --------------------------------- */
/* 공용 컴포넌트 (스피너, 버튼 등)      */
/* --------------------------------- */
/* 로딩 스피너 애니메이션 */
.spinner {
    border: 4px solid rgba(255, 255, 255, 0.2);
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border-left-color: var(--accent-color);
    animation: spin 1s ease infinite;
}

@keyframes spin {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

/* '요약 재시도' 버튼 */
.retry-button {
    background-color: var(--accent-color);
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 10px;
    transition: background-color 0.2s;
}

.retry-button:hover {
    background-color: #5a65c9;
}

/* --------------------------------- */
/* 비디오 & 참가자 관련 스타일          */
/* --------------------------------- */
/* 참가자 비디오 타일들을 감싸는 메인 컨테이너 */
.video-container {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    padding: 10px;
    width: 100%;
    height: 100%;
    align-items: center;
    justify-content: center;
    box-sizing: border-box;
    overflow-y: auto;
    transition: background-color 0.3s ease;
}

/* 개별 참가자 타일의 래퍼(wrapper) */
.video-element-container {
    position: relative;
    width: 320px;
    height: 240px;
    border-radius: 8px;
    overflow: hidden;
    background-color: var(--dark-bg-3);
    transition: all 0.3s ease; /* 크기, 그림자 등 부드러운 전환 효과 */
}

/* 실제 <video> 요소 (카메라) */
.video-element {
    width: 100%;
    height: 100%;
    background-color: #000;
    border-radius: 8px;
    object-fit: cover; /* 비율 유지하며 꽉 채우기 */
}

/* 실제 <video> 요소 (화면 공유) */
.desktop-element {
    width: 100%;
    height: 100%;
    background-color: #000;
    object-fit: contain; /* 비율 유지하며 전체 보이게 */
    border-radius: 8px;
}

/* 참가자 이름 오버레이 */
.participant-name {
    position: absolute;
    bottom: 8px;
    left: 8px;
    background-color: rgba(0, 0, 0, 0.6);
    color: white;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.9rem;
    z-index: 6;
}

/* 카메라가 없는 .video-element-container 내의 participant-name (카메라 꺼진 상태의 이름 중앙정렬) */
.video-element-container.no-video .participant-name {
    top: 50%;
    left: 50%;
    transform: translate(0%, -50%);
    width: 100%; /* 텍스트 중앙 정렬을 위해 너비 100% */
    text-align: center;
    background-color: transparent; /* 배경색 제거 */
    padding: 0;
    bottom: auto; /* 기존 bottom 속성 초기화 */
    left: auto; /* 기존 left 속성 초기화 */
}

/* '음소거됨', '카메라 꺼짐' 텍스트 스타일 */
.muted-text {
    color: var(--red-color);
    font-size: 0.9em;
    margin-left: 5px;
}

/* 말하는 중일 때 표시되는 초록색 테두리 (빛나는 효과) */
.participant.speaking-border {
    /* outline: 2px solid #1abc9c;
    outline-offset: -2px; outline을 안쪽으로 살짝 이동시켜 border처럼 보이게 함
    box-shadow: 0 0 10px 4px rgba(26, 188, 156, 0.8); */
    /* box-shadow를 사용하여 테두리 효과와 빛나는 효과를 동시에 적용 */
    box-shadow: inset 0 0 0 2px #1abc9c, /*안쪽 2px 테두리 효과 (border 대신)*/ 0 0 10px 4px rgba(26, 188, 156, 0.8); /* 기존 빛나는 효과 */
    /* 혹시 모르니 border 속성도 확실히 제거 */
    border: none;
}

/* 새로운 규칙 추가: 말하는 중인 참가자 컨테이너의 ::before 가상 요소 */
.participant.speaking-border::before {
    content: ''; /* 가상 요소 필수 속성 */
    position: absolute; /* 부모(.video-element-container) 기준 위치 */
    top: 0;
    left: 0;
    right: 0;
    bottom: 0; /* 부모 요소를 완전히 덮도록 설정 */
    border-radius: inherit; /* 부모의 둥근 모서리 상속 */

    /* 여기에 box-shadow 효과 적용 */
    box-shadow: inset 0 0 0 2px #1abc9c, /* 안쪽 테두리 효과 */ 0 0 10px 4px rgba(26, 188, 156, 0.8); /* 바깥쪽 빛나는 효과 */

    /* 중요: 가상 요소가 비디오 위에 오도록 z-index 설정 (비디오는 z-index 없으므로 1 이상이면 됨) */
    z-index: 5;

    /* 중요: 가상 요소가 마우스 이벤트를 가로채지 않도록 설정 */
    pointer-events: none;
}

/* 비디오가 없을 때 이름 첫 글자를 보여주는 플레이스홀더 */
.no-video-placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 4rem;
    font-weight: bold;
    color: var(--text-muted);
}

/* --------------------------------- */
/* 하단 컨트롤 바                    */
/* --------------------------------- */
.controls-container {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%); /* 정확한 중앙 정렬 */
    display: flex;
    gap: 15px;
    background-color: rgba(40, 40, 40, 0.8);
    padding: 10px 20px;
    border-radius: 12px;
    backdrop-filter: blur(10px); /* 반투명 블러 효과 */
    z-index: 100;
}

/* 개별 컨트롤 버튼 (마이크, 카메라 등) */
.control-button {
    position: relative;
    background-color: #4a4a4a;
    color: white;
    border: none;
    width: 50px;
    height: 50px;
    border-radius: 50%; /* 원형 버튼 */
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s;
}

.control-button:hover {
    background-color: #6a6a6a;
}

/* 활성화 상태의 버튼 (마이크 ON, 카메라 ON 등) */
.control-button.active {
    background-color: var(--accent-color);
}
.control-button.active:hover {
    background-color: #5a65c9;
}

/* '녹음 중' 상태의 버튼 */
.control-button.record.active {
    background-color: var(--red-color);
}
.control-button.record.active:hover {
    background-color: #c53737;
}

/* '통화 종료' 버튼 */
.control-button.hangup {
    background-color: var(--red-color);
}

.control-button.hangup:hover {
    background-color: #f05050;
}

.control-button svg {
    width: 24px;
    height: 24px;
}

/* '초대링크 복사' 버튼의 툴팁 */
.tooltip {
    position: absolute;
    bottom: 120%;
    left: 50%;
    transform: translateX(-50%);
    background-color: #333;
    color: white;
    padding: 5px 10px;
    border-radius: 5px;
    font-size: 0.8rem;
    white-space: nowrap;
    opacity: 0;
    transition: opacity 0.2s;
    pointer-events: none;
}

.tooltip.visible {
    opacity: 1;
}

/* --------------------------------- */
/* 스포트라이트 (참가자 화면 확대) 모드  */
/* --------------------------------- */
/* 스포트라이트 래퍼 (선택된 참가자를 감쌈) */
.main-screen-share.spotlight {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* [최적화] 선택되었거나(스포트라이트) 메인 화면에 있을 때 16:9 비율 유지 */
.video-element-container.participant-selected,
.main-screen-share.spotlight .video-element-container {
    width: 100%;
    height: 0;
    padding-bottom: 56.25%; /* 16:9 비율을 위한 padding-bottom 트릭 */
    position: relative;
    overflow: hidden;
}

/* [최적화] 선택된 비디오/데스크탑 요소를 부모(16:9) 영역에 꽉 채움 */
.video-element-container.participant-selected .video-element,
.video-element-container.participant-selected .desktop-element,
.main-screen-share.spotlight .video-element,
.main-screen-share.spotlight .desktop-element {
    position: absolute; /* 부모의 padding 영역을 무시하고 채우기 */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: contain; /* 비율을 유지하면서 컨테이너에 맞춤 */
    border-radius: 8px;
}
